{"ast":null,"code":"var _jsxFileName = \"/Users/dani/Antropoloops/atpls-player/src/ui/Player/Visuals.tsx\";\nimport React, { useEffect, useRef } from \"react\";\nimport { player } from \"../../player\";\n\nfunction handleCommands(visuals) {\n  return command => {\n    switch (command.command) {\n      case \"startClip\":\n        return visuals.startClip(command.clipId);\n\n      case \"stopClip\":\n        return visuals.stopClip(command.clipId);\n    }\n  };\n}\n\nexport const Visuals = ({\n  audioset,\n  ref\n}) => {\n  return React.createElement(\"div\", {\n    id: \"visuals\",\n    ref: ref,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19\n    },\n    __self: this\n  });\n};\n\nfunction useVisuals(audioset) {\n  const ref = useRef(null);\n  useEffect(() => {\n    import(\"../../visuals/index\").then(({\n      VisualControl\n    }) => {\n      if (ref.current && audioset) {\n        const control = new VisualControl(audioset, ref.current);\n        const removeCommands = player.onCommand(handleCommands(control));\n        return () => {\n          removeCommands();\n          control.detach();\n        };\n      }\n    });\n  }, [audioset, ref]);\n  return {\n    ref\n  };\n}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/ui/Player/Visuals.tsx"],"names":["React","useEffect","useRef","player","handleCommands","visuals","command","startClip","clipId","stopClip","Visuals","audioset","ref","useVisuals","then","VisualControl","current","control","removeCommands","onCommand","detach"],"mappings":";AAAA,OAAOA,KAAP,IAA2BC,SAA3B,EAAsCC,MAAtC,QAAoD,OAApD;AAEA,SAASC,MAAT,QAAuB,cAAvB;;AAIA,SAASC,cAAT,CAAwBC,OAAxB,EAAoD;AAClD,SAAQC,OAAD,IAA6B;AAClC,YAAQA,OAAO,CAACA,OAAhB;AACE,WAAK,WAAL;AACE,eAAOD,OAAO,CAACE,SAAR,CAAkBD,OAAO,CAACE,MAA1B,CAAP;;AACF,WAAK,UAAL;AACE,eAAOH,OAAO,CAACI,QAAR,CAAiBH,OAAO,CAACE,MAAzB,CAAP;AAJJ;AAMD,GAPD;AAQD;;AAED,OAAO,MAAME,OAAO,GAAG,CAAC;AAAEC,EAAAA,QAAF;AAAYC,EAAAA;AAAZ,CAAD,KAAqC;AAC1D,SAAO;AAAK,IAAA,EAAE,EAAC,SAAR;AAAkB,IAAA,GAAG,EAAEA,GAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACD,CAFM;;AAQP,SAASC,UAAT,CAAoBF,QAApB,EAAwC;AACtC,QAAMC,GAAG,GAAGV,MAAM,CAAiB,IAAjB,CAAlB;AACAD,EAAAA,SAAS,CAAC,MAAM;AACd,WAAO,qBAAP,EAA8Ba,IAA9B,CAAmC,CAAC;AAAEC,MAAAA;AAAF,KAAD,KAAuB;AACxD,UAAIH,GAAG,CAACI,OAAJ,IAAeL,QAAnB,EAA6B;AAC3B,cAAMM,OAAO,GAAG,IAAIF,aAAJ,CAAkBJ,QAAlB,EAA4BC,GAAG,CAACI,OAAhC,CAAhB;AACA,cAAME,cAAc,GAAGf,MAAM,CAACgB,SAAP,CAAiBf,cAAc,CAACa,OAAD,CAA/B,CAAvB;AACA,eAAO,MAAM;AACXC,UAAAA,cAAc;AACdD,UAAAA,OAAO,CAACG,MAAR;AACD,SAHD;AAID;AACF,KATD;AAUD,GAXQ,EAWN,CAACT,QAAD,EAAWC,GAAX,CAXM,CAAT;AAaA,SAAO;AAAEA,IAAAA;AAAF,GAAP;AACD","sourcesContent":["import React, { RefObject, useEffect, useRef } from \"react\";\nimport { Audioset } from \"../../audioset\";\nimport { player } from \"../../player\";\nimport { ControlCommand } from \"../../player/Control\";\nimport { VisualControl as VisualControlType } from \"../../visuals\";\n\nfunction handleCommands(visuals: VisualControlType) {\n  return (command: ControlCommand) => {\n    switch (command.command) {\n      case \"startClip\":\n        return visuals.startClip(command.clipId);\n      case \"stopClip\":\n        return visuals.stopClip(command.clipId);\n    }\n  };\n}\n\nexport const Visuals = ({ audioset, ref }: VisualsProps) => {\n  return <div id=\"visuals\" ref={ref} />;\n};\ninterface VisualsProps {\n  audioset: Audioset;\n  ref: RefObject<HTMLDivElement>;\n}\n\nfunction useVisuals(audioset: Audioset) {\n  const ref = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    import(\"../../visuals/index\").then(({ VisualControl }) => {\n      if (ref.current && audioset) {\n        const control = new VisualControl(audioset, ref.current);\n        const removeCommands = player.onCommand(handleCommands(control));\n        return () => {\n          removeCommands();\n          control.detach();\n        };\n      }\n    });\n  }, [audioset, ref]);\n\n  return { ref };\n}\n"]},"metadata":{},"sourceType":"module"}