{"ast":null,"code":"import _slicedToArray from\"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useEffect}from\"react\";import{player}from\"../../Player\";export var Visuals=function Visuals(_ref){var audioset=_ref.audioset;var ref=useRef(null);var visuals=useVisuals(audioset,ref);return React.createElement(\"div\",{id:\"visuals\",ref:ref});};function handleCommands(visuals){return function(command){switch(command.command){case\"startClip\":return visuals.startClip(command.clipId);case\"stopClip\":return visuals.stopClip(command.clipId);}};}function useVisuals(audioset,ref){var _useState=useState(),_useState2=_slicedToArray(_useState,2),visuals=_useState2[0],setVisuals=_useState2[1];useEffect(function(){import(\"../../visuals/index\").then(function(_ref2){var VisualControl=_ref2.VisualControl;if(ref.current&&audioset){var _visuals=new VisualControl(audioset,ref.current);var removeCommands=player.onCommand(handleCommands(_visuals));return function(){removeCommands();_visuals.detach();};}});},[audioset,ref.current]);return{visuals:visuals};}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/App/Player/Visuals.tsx"],"names":["React","useRef","useState","useEffect","player","Visuals","audioset","ref","visuals","useVisuals","handleCommands","command","startClip","clipId","stopClip","setVisuals","then","VisualControl","current","removeCommands","onCommand","detach"],"mappings":"4JAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,QAAxB,CAAkCC,SAAlC,KAA8D,OAA9D,CAEA,OAASC,MAAT,KAAuB,cAAvB,CAIA,MAAO,IAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,MAAgC,IAA7BC,CAAAA,QAA6B,MAA7BA,QAA6B,CACrD,GAAMC,CAAAA,GAAG,CAAGN,MAAM,CAAiB,IAAjB,CAAlB,CACA,GAAMO,CAAAA,OAAO,CAAGC,UAAU,CAACH,QAAD,CAAWC,GAAX,CAA1B,CACA,MAAO,4BAAK,EAAE,CAAC,SAAR,CAAkB,GAAG,CAAEA,GAAvB,EAAP,CACD,CAJM,CASP,QAASG,CAAAA,cAAT,CAAwBF,OAAxB,CAAgD,CAC9C,MAAO,UAASG,OAAT,CAAkC,CACvC,OAAQA,OAAO,CAACA,OAAhB,EACE,IAAK,WAAL,CACE,MAAOH,CAAAA,OAAO,CAACI,SAAR,CAAkBD,OAAO,CAACE,MAA1B,CAAP,CACF,IAAK,UAAL,CACE,MAAOL,CAAAA,OAAO,CAACM,QAAR,CAAiBH,OAAO,CAACE,MAAzB,CAAP,CAJJ,CAMD,CAPD,CAQD,CAMD,QAASJ,CAAAA,UAAT,CAAoBH,QAApB,CAAwCC,GAAxC,CAAwE,eACxCL,QAAQ,EADgC,wCAC/DM,OAD+D,eACtDO,UADsD,eAGtEZ,SAAS,CACP,UAAM,CACJ,OAAO,qBAAP,EAA8Ba,IAA9B,CAAmC,eAAuB,IAApBC,CAAAA,aAAoB,OAApBA,aAAoB,CACxD,GAAIV,GAAG,CAACW,OAAJ,EAAeZ,QAAnB,CAA6B,CAC3B,GAAME,CAAAA,QAAO,CAAG,GAAIS,CAAAA,aAAJ,CAAkBX,QAAlB,CAA4BC,GAAG,CAACW,OAAhC,CAAhB,CACA,GAAMC,CAAAA,cAAc,CAAGf,MAAM,CAACgB,SAAP,CAAiBV,cAAc,CAACF,QAAD,CAA/B,CAAvB,CACA,MAAO,WAAM,CACXW,cAAc,GACdX,QAAO,CAACa,MAAR,GACD,CAHD,CAID,CACF,CATD,EAUD,CAZM,CAaP,CAACf,QAAD,CAAWC,GAAG,CAACW,OAAf,CAbO,CAAT,CAgBA,MAAO,CAAEV,OAAO,CAAPA,OAAF,CAAP,CACD","sourcesContent":["import React, { useRef, useState, useEffect, RefObject } from \"react\";\nimport { Audioset } from \"../../Audioset\";\nimport { player } from \"../../Player\";\nimport { ControlCommand } from \"../../Player/AudiosetControl\";\nimport { VisualControl } from \"../../visuals\";\n\nexport const Visuals = ({ audioset }: VisualsProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const visuals = useVisuals(audioset, ref);\n  return <div id=\"visuals\" ref={ref} />;\n};\ninterface VisualsProps {\n  audioset: Audioset;\n}\n\nfunction handleCommands(visuals: VisualControl) {\n  return function(command: ControlCommand) {\n    switch (command.command) {\n      case \"startClip\":\n        return visuals.startClip(command.clipId);\n      case \"stopClip\":\n        return visuals.stopClip(command.clipId);\n    }\n  };\n}\n\ninterface VisualsModule {\n  createVisuals(audioset: Audioset, el: HTMLDivElement): {};\n}\n\nfunction useVisuals(audioset: Audioset, ref: RefObject<HTMLDivElement>) {\n  const [visuals, setVisuals] = useState();\n\n  useEffect(\n    () => {\n      import(\"../../visuals/index\").then(({ VisualControl }) => {\n        if (ref.current && audioset) {\n          const visuals = new VisualControl(audioset, ref.current);\n          const removeCommands = player.onCommand(handleCommands(visuals));\n          return () => {\n            removeCommands();\n            visuals.detach();\n          };\n        }\n      });\n    },\n    [audioset, ref.current],\n  );\n\n  return { visuals };\n}\n"]},"metadata":{},"sourceType":"module"}