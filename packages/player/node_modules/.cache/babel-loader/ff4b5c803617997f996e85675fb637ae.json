{"ast":null,"code":"export const createEvaluateSource = window => {\n  return source => new Promise((resolve, reject) => {\n    if (window === null) {\n      reject(new SyntaxError());\n      return;\n    }\n\n    const head = window.document.head;\n\n    if (head === null) {\n      reject(new SyntaxError());\n    } else {\n      const script = window.document.createElement('script'); // @todo Safari doesn't like URLs with a type of 'application/javascript; charset=utf-8'.\n\n      const blob = new Blob([source], {\n        type: 'application/javascript'\n      });\n      const url = URL.createObjectURL(blob);\n      const originalOnErrorHandler = window.onerror;\n\n      const removeErrorEventListenerAndRevokeUrl = () => {\n        window.onerror = originalOnErrorHandler;\n        URL.revokeObjectURL(url);\n      };\n\n      window.onerror = (message, src, lineno, colno, error) => {\n        // @todo Edge thinks the source is the one of the html document.\n        if (src === url || src === location.href && lineno === 1 && colno === 1) {\n          removeErrorEventListenerAndRevokeUrl();\n          reject(error);\n          return false;\n        }\n\n        if (originalOnErrorHandler !== null) {\n          return originalOnErrorHandler(message, src, lineno, colno, error);\n        }\n      };\n\n      script.onerror = () => {\n        removeErrorEventListenerAndRevokeUrl();\n        reject(new SyntaxError());\n      };\n\n      script.onload = () => {\n        removeErrorEventListenerAndRevokeUrl();\n        resolve();\n      };\n\n      script.src = url;\n      script.type = 'module';\n      head.appendChild(script);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/node_modules/standardized-audio-context/build/es2018/factories/evaluate-source.js"],"names":["createEvaluateSource","window","source","Promise","resolve","reject","SyntaxError","head","document","script","createElement","blob","Blob","type","url","URL","createObjectURL","originalOnErrorHandler","onerror","removeErrorEventListenerAndRevokeUrl","revokeObjectURL","message","src","lineno","colno","error","location","href","onload","appendChild"],"mappings":"AAAA,OAAO,MAAMA,oBAAoB,GAAIC,MAAD,IAAY;AAC5C,SAAQC,MAAD,IAAY,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAChD,QAAIJ,MAAM,KAAK,IAAf,EAAqB;AACjBI,MAAAA,MAAM,CAAC,IAAIC,WAAJ,EAAD,CAAN;AACA;AACH;;AACD,UAAMC,IAAI,GAAGN,MAAM,CAACO,QAAP,CAAgBD,IAA7B;;AACA,QAAIA,IAAI,KAAK,IAAb,EAAmB;AACfF,MAAAA,MAAM,CAAC,IAAIC,WAAJ,EAAD,CAAN;AACH,KAFD,MAGK;AACD,YAAMG,MAAM,GAAGR,MAAM,CAACO,QAAP,CAAgBE,aAAhB,CAA8B,QAA9B,CAAf,CADC,CAED;;AACA,YAAMC,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACV,MAAD,CAAT,EAAmB;AAAEW,QAAAA,IAAI,EAAE;AAAR,OAAnB,CAAb;AACA,YAAMC,GAAG,GAAGC,GAAG,CAACC,eAAJ,CAAoBL,IAApB,CAAZ;AACA,YAAMM,sBAAsB,GAAGhB,MAAM,CAACiB,OAAtC;;AACA,YAAMC,oCAAoC,GAAG,MAAM;AAC/ClB,QAAAA,MAAM,CAACiB,OAAP,GAAiBD,sBAAjB;AACAF,QAAAA,GAAG,CAACK,eAAJ,CAAoBN,GAApB;AACH,OAHD;;AAIAb,MAAAA,MAAM,CAACiB,OAAP,GAAiB,CAACG,OAAD,EAAUC,GAAV,EAAeC,MAAf,EAAuBC,KAAvB,EAA8BC,KAA9B,KAAwC;AACrD;AACA,YAAIH,GAAG,KAAKR,GAAR,IAAgBQ,GAAG,KAAKI,QAAQ,CAACC,IAAjB,IAAyBJ,MAAM,KAAK,CAApC,IAAyCC,KAAK,KAAK,CAAvE,EAA2E;AACvEL,UAAAA,oCAAoC;AACpCd,UAAAA,MAAM,CAACoB,KAAD,CAAN;AACA,iBAAO,KAAP;AACH;;AACD,YAAIR,sBAAsB,KAAK,IAA/B,EAAqC;AACjC,iBAAOA,sBAAsB,CAACI,OAAD,EAAUC,GAAV,EAAeC,MAAf,EAAuBC,KAAvB,EAA8BC,KAA9B,CAA7B;AACH;AACJ,OAVD;;AAWAhB,MAAAA,MAAM,CAACS,OAAP,GAAiB,MAAM;AACnBC,QAAAA,oCAAoC;AACpCd,QAAAA,MAAM,CAAC,IAAIC,WAAJ,EAAD,CAAN;AACH,OAHD;;AAIAG,MAAAA,MAAM,CAACmB,MAAP,GAAgB,MAAM;AAClBT,QAAAA,oCAAoC;AACpCf,QAAAA,OAAO;AACV,OAHD;;AAIAK,MAAAA,MAAM,CAACa,GAAP,GAAaR,GAAb;AACAL,MAAAA,MAAM,CAACI,IAAP,GAAc,QAAd;AACAN,MAAAA,IAAI,CAACsB,WAAL,CAAiBpB,MAAjB;AACH;AACJ,GA1CkB,CAAnB;AA2CH,CA5CM","sourcesContent":["export const createEvaluateSource = (window) => {\n    return (source) => new Promise((resolve, reject) => {\n        if (window === null) {\n            reject(new SyntaxError());\n            return;\n        }\n        const head = window.document.head;\n        if (head === null) {\n            reject(new SyntaxError());\n        }\n        else {\n            const script = window.document.createElement('script');\n            // @todo Safari doesn't like URLs with a type of 'application/javascript; charset=utf-8'.\n            const blob = new Blob([source], { type: 'application/javascript' });\n            const url = URL.createObjectURL(blob);\n            const originalOnErrorHandler = window.onerror;\n            const removeErrorEventListenerAndRevokeUrl = () => {\n                window.onerror = originalOnErrorHandler;\n                URL.revokeObjectURL(url);\n            };\n            window.onerror = (message, src, lineno, colno, error) => {\n                // @todo Edge thinks the source is the one of the html document.\n                if (src === url || (src === location.href && lineno === 1 && colno === 1)) {\n                    removeErrorEventListenerAndRevokeUrl();\n                    reject(error);\n                    return false;\n                }\n                if (originalOnErrorHandler !== null) {\n                    return originalOnErrorHandler(message, src, lineno, colno, error);\n                }\n            };\n            script.onerror = () => {\n                removeErrorEventListenerAndRevokeUrl();\n                reject(new SyntaxError());\n            };\n            script.onload = () => {\n                removeErrorEventListenerAndRevokeUrl();\n                resolve();\n            };\n            script.src = url;\n            script.type = 'module';\n            head.appendChild(script);\n        }\n    });\n};\n//# sourceMappingURL=/build/es2018/factories/evaluate-source.js.map"]},"metadata":{},"sourceType":"module"}