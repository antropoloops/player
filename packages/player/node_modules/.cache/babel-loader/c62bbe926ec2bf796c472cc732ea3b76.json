{"ast":null,"code":"import React,{useEffect,useRef}from\"react\";import{player}from\"../../player\";function handleCommands(visuals){return function(command){switch(command.command){case\"startClip\":return visuals.startClip(command.clipId);case\"stopClip\":return visuals.stopClip(command.clipId);}};}export var Visuals=function Visuals(_ref){var audioset=_ref.audioset;var ref=useRef(null);useVisuals(audioset,ref);return React.createElement(\"div\",{id:\"visuals\",ref:ref});};function useVisuals(audioset,ref){useEffect(function(){import(\"../../visuals/index\").then(function(_ref2){var VisualControl=_ref2.VisualControl;if(ref.current&&audioset){var control=new VisualControl(audioset,ref.current);var removeCommands=player.onCommand(handleCommands(control));return function(){removeCommands();control.detach();};}});},[audioset,ref]);}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/ui/Player/Visuals.tsx"],"names":["React","useEffect","useRef","player","handleCommands","visuals","command","startClip","clipId","stopClip","Visuals","audioset","ref","useVisuals","then","VisualControl","current","control","removeCommands","onCommand","detach"],"mappings":"AAAA,MAAOA,CAAAA,KAAP,EAA2BC,SAA3B,CAAsCC,MAAtC,KAAoD,OAApD,CAEA,OAASC,MAAT,KAAuB,cAAvB,CAIA,QAASC,CAAAA,cAAT,CAAwBC,OAAxB,CAAoD,CAClD,MAAO,UAACC,OAAD,CAA6B,CAClC,OAAQA,OAAO,CAACA,OAAhB,EACE,IAAK,WAAL,CACE,MAAOD,CAAAA,OAAO,CAACE,SAAR,CAAkBD,OAAO,CAACE,MAA1B,CAAP,CACF,IAAK,UAAL,CACE,MAAOH,CAAAA,OAAO,CAACI,QAAR,CAAiBH,OAAO,CAACE,MAAzB,CAAP,CAJJ,CAMD,CAPD,CAQD,CAED,MAAO,IAAME,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,MAAgC,IAA7BC,CAAAA,QAA6B,MAA7BA,QAA6B,CACrD,GAAMC,CAAAA,GAAG,CAAGV,MAAM,CAAiB,IAAjB,CAAlB,CACAW,UAAU,CAACF,QAAD,CAAWC,GAAX,CAAV,CACA,MAAO,4BAAK,EAAE,CAAC,SAAR,CAAkB,GAAG,CAAEA,GAAvB,EAAP,CACD,CAJM,CASP,QAASC,CAAAA,UAAT,CAAoBF,QAApB,CAAwCC,GAAxC,CAAwE,CACtEX,SAAS,CAAC,UAAM,CACd,OAAO,qBAAP,EAA8Ba,IAA9B,CAAmC,eAAuB,IAApBC,CAAAA,aAAoB,OAApBA,aAAoB,CACxD,GAAIH,GAAG,CAACI,OAAJ,EAAeL,QAAnB,CAA6B,CAC3B,GAAMM,CAAAA,OAAO,CAAG,GAAIF,CAAAA,aAAJ,CAAkBJ,QAAlB,CAA4BC,GAAG,CAACI,OAAhC,CAAhB,CACA,GAAME,CAAAA,cAAc,CAAGf,MAAM,CAACgB,SAAP,CAAiBf,cAAc,CAACa,OAAD,CAA/B,CAAvB,CACA,MAAO,WAAM,CACXC,cAAc,GACdD,OAAO,CAACG,MAAR,GACD,CAHD,CAID,CACF,CATD,EAUD,CAXQ,CAWN,CAACT,QAAD,CAAWC,GAAX,CAXM,CAAT,CAYD","sourcesContent":["import React, { RefObject, useEffect, useRef } from \"react\";\nimport { Audioset } from \"../../audioset\";\nimport { player } from \"../../player\";\nimport { ControlCommand } from \"../../player/AudiosetControl\";\nimport { VisualControl as VisualControlType } from \"../../visuals\";\n\nfunction handleCommands(visuals: VisualControlType) {\n  return (command: ControlCommand) => {\n    switch (command.command) {\n      case \"startClip\":\n        return visuals.startClip(command.clipId);\n      case \"stopClip\":\n        return visuals.stopClip(command.clipId);\n    }\n  };\n}\n\nexport const Visuals = ({ audioset }: VisualsProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n  useVisuals(audioset, ref);\n  return <div id=\"visuals\" ref={ref} />;\n};\ninterface VisualsProps {\n  audioset: Audioset;\n}\n\nfunction useVisuals(audioset: Audioset, ref: RefObject<HTMLDivElement>) {\n  useEffect(() => {\n    import(\"../../visuals/index\").then(({ VisualControl }) => {\n      if (ref.current && audioset) {\n        const control = new VisualControl(audioset, ref.current);\n        const removeCommands = player.onCommand(handleCommands(control));\n        return () => {\n          removeCommands();\n          control.detach();\n        };\n      }\n    });\n  }, [audioset, ref]);\n}\n"]},"metadata":{},"sourceType":"module"}