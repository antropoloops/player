{"ast":null,"code":"import _defineProperty from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nclass TimeManager {\n  constructor() {\n    this.NOT_PLAYING = 0;\n    this.playingClipsCount = 0;\n    this.startedAt = NOT_PLAYING;\n  }\n\n  startTime(time) {\n    if (this.playingClipsCount === 0 && n > 0) {\n      this.startedAt = time;\n    }\n\n    this.playingClipsCount += 1;\n\n    if (this.playingClipsCount === 0) {\n      this.startedAt = NOT_PLAYING;\n    }\n  }\n\n}\n/**\n * It handles the state of the control\n */\n\n\nexport class ControlStateManager {\n  constructor() {\n    this.clipStateByClipId = {};\n    this.clipIdsOfTrack = {};\n    this.trackIdOfClip = {};\n    this.trackStateByTrackId = {};\n  }\n\n  addClip(clip) {\n    this.clipStateByClipId[clip.id] = {\n      state: \"stopped\"\n    };\n    this.trackIdOfClip[clip.id] = clip.trackId;\n  }\n\n  addTrack(track) {\n    const volume = track.volume || 1;\n    this.trackStateByTrackId[track.id] = {\n      state: \"stopped\",\n      volume\n    };\n    this.clipIdsOfTrack[track.id] = track.clipIds;\n  }\n\n  getAllClipIds() {\n    return Object.keys(this.clipStateByClipId);\n  }\n\n  getAllTrackIds() {\n    return Object.keys(this.trackStateByTrackId);\n  }\n\n  getClipState(clipId) {\n    return this.clipStateByClipId[clipId];\n  }\n\n  setClipState(clipId, newStsate) {\n    this.clipStateByClipId[clipId] = newStsate;\n  }\n\n  getTrackState(trackId) {\n    return this.trackStateByTrackId[trackId];\n  }\n\n  setTrackState(trackId, state) {\n    this.trackStateByTrackId[trackId] = state;\n  }\n\n  getTrackIdOfClip(clipId) {\n    return this.trackIdOfClip[clipId];\n  }\n\n  getClipIdsOfTrack(trackId) {\n    return this.clipIdsOfTrack[trackId];\n  }\n\n  getState() {\n    return {\n      clips: _objectSpread({}, this.clipStateByClipId),\n      tracks: _objectSpread({}, this.trackStateByTrackId)\n    };\n  }\n\n}\nexport class PlayerControl extends ControlStateManager {}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/player/Control/ControlStateManager.ts"],"names":["TimeManager","NOT_PLAYING","playingClipsCount","startedAt","startTime","time","n","ControlStateManager","clipStateByClipId","clipIdsOfTrack","trackIdOfClip","trackStateByTrackId","addClip","clip","id","state","trackId","addTrack","track","volume","clipIds","getAllClipIds","Object","keys","getAllTrackIds","getClipState","clipId","setClipState","newStsate","getTrackState","setTrackState","getTrackIdOfClip","getClipIdsOfTrack","getState","clips","tracks","PlayerControl"],"mappings":";;;;;;AAQA,MAAMA,WAAN,CAAkB;AAAA;AAAA,SACXC,WADW,GACG,CADH;AAAA,SAENC,iBAFM,GAEsB,CAFtB;AAAA,SAGNC,SAHM,GAGcF,WAHd;AAAA;;AAKTG,EAAAA,SAAP,CAAiBC,IAAjB,EAA+B;AAC7B,QAAI,KAAKH,iBAAL,KAA2B,CAA3B,IAAgCI,CAAC,GAAG,CAAxC,EAA2C;AACzC,WAAKH,SAAL,GAAiBE,IAAjB;AACD;;AACD,SAAKH,iBAAL,IAA0B,CAA1B;;AACA,QAAI,KAAKA,iBAAL,KAA2B,CAA/B,EAAkC;AAChC,WAAKC,SAAL,GAAiBF,WAAjB;AACD;AACF;;AAbe;AAgBlB;;;;;AAGA,OAAO,MAAMM,mBAAN,CAA0B;AAAA;AAAA,SACvBC,iBADuB,GACuB,EADvB;AAAA,SAEvBC,cAFuB,GAEoB,EAFpB;AAAA,SAGvBC,aAHuB,GAGiB,EAHjB;AAAA,SAIvBC,mBAJuB,GAI2B,EAJ3B;AAAA;;AAMxBC,EAAAA,OAAP,CAAeC,IAAf,EAA2B;AACzB,SAAKL,iBAAL,CAAuBK,IAAI,CAACC,EAA5B,IAAkC;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAAlC;AACA,SAAKL,aAAL,CAAmBG,IAAI,CAACC,EAAxB,IAA8BD,IAAI,CAACG,OAAnC;AACD;;AACMC,EAAAA,QAAP,CAAgBC,KAAhB,EAA8B;AAC5B,UAAMC,MAAM,GAAGD,KAAK,CAACC,MAAN,IAAgB,CAA/B;AACA,SAAKR,mBAAL,CAAyBO,KAAK,CAACJ,EAA/B,IAAqC;AAAEC,MAAAA,KAAK,EAAE,SAAT;AAAoBI,MAAAA;AAApB,KAArC;AACA,SAAKV,cAAL,CAAoBS,KAAK,CAACJ,EAA1B,IAAgCI,KAAK,CAACE,OAAtC;AACD;;AACMC,EAAAA,aAAP,GAAuB;AACrB,WAAOC,MAAM,CAACC,IAAP,CAAY,KAAKf,iBAAjB,CAAP;AACD;;AACMgB,EAAAA,cAAP,GAAwB;AACtB,WAAOF,MAAM,CAACC,IAAP,CAAY,KAAKZ,mBAAjB,CAAP;AACD;;AACMc,EAAAA,YAAP,CAAoBC,MAApB,EAAoC;AAClC,WAAO,KAAKlB,iBAAL,CAAuBkB,MAAvB,CAAP;AACD;;AACMC,EAAAA,YAAP,CAAoBD,MAApB,EAAoCE,SAApC,EAAiE;AAC/D,SAAKpB,iBAAL,CAAuBkB,MAAvB,IAAiCE,SAAjC;AACD;;AACMC,EAAAA,aAAP,CAAqBb,OAArB,EAAsC;AACpC,WAAO,KAAKL,mBAAL,CAAyBK,OAAzB,CAAP;AACD;;AACMc,EAAAA,aAAP,CAAqBd,OAArB,EAAsCD,KAAtC,EAAgE;AAC9D,SAAKJ,mBAAL,CAAyBK,OAAzB,IAAoCD,KAApC;AACD;;AACMgB,EAAAA,gBAAP,CAAwBL,MAAxB,EAAwC;AACtC,WAAO,KAAKhB,aAAL,CAAmBgB,MAAnB,CAAP;AACD;;AACMM,EAAAA,iBAAP,CAAyBhB,OAAzB,EAA0C;AACxC,WAAO,KAAKP,cAAL,CAAoBO,OAApB,CAAP;AACD;;AACMiB,EAAAA,QAAP,GAAgC;AAC9B,WAAO;AACLC,MAAAA,KAAK,oBAAO,KAAK1B,iBAAZ,CADA;AAEL2B,MAAAA,MAAM,oBAAO,KAAKxB,mBAAZ;AAFD,KAAP;AAID;;AA5C8B;AA+CjC,OAAO,MAAMyB,aAAN,SAA4B7B,mBAA5B,CAAgD","sourcesContent":["import { Clip, Track } from \"../../audioset\";\nimport {\n  ClipPlayingStateByClipId,\n  ControlState,\n  TrackPlayingStateByTrackId,\n} from \"./ControlState\";\nimport { ClipPlayingState, TrackPlayingState } from \"./PlayingState\";\n\nclass TimeManager {\npublic NOT_PLAYING = 0;\n  protected playingClipsCount: number = 0;\n  protected startedAt: number = NOT_PLAYING;\n\n  public startTime(time: number) {\n    if (this.playingClipsCount === 0 && n > 0) {\n      this.startedAt = time;\n    }\n    this.playingClipsCount += 1;\n    if (this.playingClipsCount === 0) {\n      this.startedAt = NOT_PLAYING;\n    }\n  }\n}\n\n/**\n * It handles the state of the control\n */\nexport class ControlStateManager {\n  private clipStateByClipId: ClipPlayingStateByClipId = {};\n  private clipIdsOfTrack: Record<string, string[]> = {};\n  private trackIdOfClip: Record<string, string> = {};\n  private trackStateByTrackId: TrackPlayingStateByTrackId = {};\n\n  public addClip(clip: Clip) {\n    this.clipStateByClipId[clip.id] = { state: \"stopped\" };\n    this.trackIdOfClip[clip.id] = clip.trackId;\n  }\n  public addTrack(track: Track) {\n    const volume = track.volume || 1;\n    this.trackStateByTrackId[track.id] = { state: \"stopped\", volume };\n    this.clipIdsOfTrack[track.id] = track.clipIds;\n  }\n  public getAllClipIds() {\n    return Object.keys(this.clipStateByClipId);\n  }\n  public getAllTrackIds() {\n    return Object.keys(this.trackStateByTrackId);\n  }\n  public getClipState(clipId: string) {\n    return this.clipStateByClipId[clipId];\n  }\n  public setClipState(clipId: string, newStsate: ClipPlayingState) {\n    this.clipStateByClipId[clipId] = newStsate;\n  }\n  public getTrackState(trackId: string) {\n    return this.trackStateByTrackId[trackId];\n  }\n  public setTrackState(trackId: string, state: TrackPlayingState) {\n    this.trackStateByTrackId[trackId] = state;\n  }\n  public getTrackIdOfClip(clipId: string) {\n    return this.trackIdOfClip[clipId];\n  }\n  public getClipIdsOfTrack(trackId: string) {\n    return this.clipIdsOfTrack[trackId];\n  }\n  public getState(): ControlState {\n    return {\n      clips: { ...this.clipStateByClipId },\n      tracks: { ...this.trackStateByTrackId },\n    };\n  }\n}\n\nexport class PlayerControl extends ControlStateManager {}\n"]},"metadata":{},"sourceType":"module"}