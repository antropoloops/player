{"ast":null,"code":"import * as d3 from \"d3\";\nimport { getCoverSize } from \"./dimensions\";\nexport default function drawRefLine(parent, width, cx, cy, clip) {\n  const x1 = getCoverSize(width) * (clip.trackNum + 0.5);\n  const y1 = 0;\n  const x2 = cx;\n  const y2 = cy;\n  const h = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n  const a = h / 10;\n  const alfa = Math.acos((y2 - y1) / h);\n  const curveCoords = [{\n    x: x1,\n    y: y1\n  }, {\n    x: x1 + (x2 - x1) / 2 + a * Math.cos(Math.PI - alfa),\n    y: y1 + (y2 - y1) / 2 + a * Math.sin(Math.PI - alfa)\n  }, {\n    x: x2,\n    y: y2\n  }];\n  const line = d3.line().x(d => d.x).y(d => d.y).curve(d3.curveBasis);\n  const refLine = parent.append(\"path\").datum(curveCoords).attr(\"d\", line).style(\"stroke\", clip.color).style(\"stroke-dasharray\", \"2, 3\").style(\"fill\", \"none\").style(\"stroke-width\", 2);\n  return refLine;\n}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/visuals/drawRefLine.ts"],"names":["d3","getCoverSize","drawRefLine","parent","width","cx","cy","clip","x1","trackNum","y1","x2","y2","h","Math","sqrt","pow","a","alfa","acos","curveCoords","x","y","cos","PI","sin","line","d","curve","curveBasis","refLine","append","datum","attr","style","color"],"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,IAApB;AACA,SAASC,YAAT,QAA6B,cAA7B;AAQA,eAAe,SAASC,WAAT,CAAqBC,MAArB,EAA0CC,KAA1C,EAAyDC,EAAzD,EAAkEC,EAAlE,EAA2EC,IAA3E,EAAgG;AAC7G,QAAMC,EAAE,GAAGP,YAAY,CAACG,KAAD,CAAZ,IAAuBG,IAAI,CAACE,QAAL,GAAgB,GAAvC,CAAX;AACA,QAAMC,EAAE,GAAG,CAAX;AACA,QAAMC,EAAE,GAAGN,EAAX;AACA,QAAMO,EAAE,GAAGN,EAAX;AACA,QAAMO,CAAC,GAAGC,IAAI,CAACC,IAAL,CAAUD,IAAI,CAACE,GAAL,CAASL,EAAE,GAAGH,EAAd,EAAkB,CAAlB,IAAuBM,IAAI,CAACE,GAAL,CAASJ,EAAE,GAAGF,EAAd,EAAkB,CAAlB,CAAjC,CAAV;AACA,QAAMO,CAAC,GAAGJ,CAAC,GAAG,EAAd;AACA,QAAMK,IAAI,GAAGJ,IAAI,CAACK,IAAL,CAAU,CAACP,EAAE,GAAGF,EAAN,IAAYG,CAAtB,CAAb;AACA,QAAMO,WAAuB,GAAG,CAC9B;AACEC,IAAAA,CAAC,EAAEb,EADL;AAEEc,IAAAA,CAAC,EAAEZ;AAFL,GAD8B,EAK9B;AACEW,IAAAA,CAAC,EAAEb,EAAE,GAAG,CAACG,EAAE,GAAGH,EAAN,IAAY,CAAjB,GAAqBS,CAAC,GAAGH,IAAI,CAACS,GAAL,CAAST,IAAI,CAACU,EAAL,GAAUN,IAAnB,CAD9B;AAEEI,IAAAA,CAAC,EAAEZ,EAAE,GAAG,CAACE,EAAE,GAAGF,EAAN,IAAY,CAAjB,GAAqBO,CAAC,GAAGH,IAAI,CAACW,GAAL,CAASX,IAAI,CAACU,EAAL,GAAUN,IAAnB;AAF9B,GAL8B,EAS9B;AAAEG,IAAAA,CAAC,EAAEV,EAAL;AAASW,IAAAA,CAAC,EAAEV;AAAZ,GAT8B,CAAhC;AAYA,QAAMc,IAAI,GAAG1B,EAAE,CAAC0B,IAAH,GAAoBL,CAApB,CAAuBM,CAAD,IAAiBA,CAAC,CAACN,CAAzC,EAA4CC,CAA5C,CAA+CK,CAAD,IAAiBA,CAAC,CAACL,CAAjE,EAAoEM,KAApE,CAA0E5B,EAAE,CAAC6B,UAA7E,CAAb;AAEA,QAAMC,OAAO,GAAG3B,MAAM,CACnB4B,MADa,CACN,MADM,EAEbC,KAFa,CAEPZ,WAFO,EAGba,IAHa,CAGR,GAHQ,EAGHP,IAHG,EAIbQ,KAJa,CAIP,QAJO,EAIG3B,IAAI,CAAC4B,KAJR,EAKbD,KALa,CAKP,kBALO,EAKa,MALb,EAMbA,KANa,CAMP,MANO,EAMC,MAND,EAObA,KAPa,CAOP,cAPO,EAOS,CAPT,CAAhB;AASA,SAAOJ,OAAP;AACD","sourcesContent":["import * as d3 from \"d3\";\nimport { getCoverSize } from \"./dimensions\";\nimport { D3Selection } from \"./visuals\";\nimport { Clip } from \"../Audioset\";\n\ntype Position = { x: number; y: number };\n\nexport type RefLine = d3.Selection<SVGPathElement, Position[], null, undefined>;\n\nexport default function drawRefLine(parent: D3Selection, width: number, cx: any, cy: any, clip: Clip): RefLine {\n  const x1 = getCoverSize(width) * (clip.trackNum + 0.5);\n  const y1 = 0;\n  const x2 = cx;\n  const y2 = cy;\n  const h = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n  const a = h / 10;\n  const alfa = Math.acos((y2 - y1) / h);\n  const curveCoords: Position[] = [\n    {\n      x: x1,\n      y: y1,\n    },\n    {\n      x: x1 + (x2 - x1) / 2 + a * Math.cos(Math.PI - alfa),\n      y: y1 + (y2 - y1) / 2 + a * Math.sin(Math.PI - alfa),\n    },\n    { x: x2, y: y2 },\n  ];\n\n  const line = d3.line<Position>().x((d: Position) => d.x).y((d: Position) => d.y).curve(d3.curveBasis);\n\n  const refLine = parent\n    .append(\"path\")\n    .datum(curveCoords)\n    .attr(\"d\", line)\n    .style(\"stroke\", clip.color)\n    .style(\"stroke-dasharray\", \"2, 3\")\n    .style(\"fill\", \"none\")\n    .style(\"stroke-width\", 2);\n\n  return refLine;\n}\n"]},"metadata":{},"sourceType":"module"}