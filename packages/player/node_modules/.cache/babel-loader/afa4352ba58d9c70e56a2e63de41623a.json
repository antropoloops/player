{"ast":null,"code":"import _defineProperty from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nvar DEFAULT_OPTIONS = {\n  channelCount: 2,\n  channelCountMode: 'max',\n  channelInterpretation: 'speakers',\n  offset: 1\n};\nexport var createConstantSourceNodeConstructor = function createConstantSourceNodeConstructor(audioNodeConstructor, createAudioParam, createConstantSourceNodeRendererFactory, createNativeConstantSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) {\n  return (\n    /*#__PURE__*/\n    function (_audioNodeConstructor) {\n      _inherits(ConstantSourceNode, _audioNodeConstructor);\n\n      function ConstantSourceNode(context) {\n        var _this;\n\n        var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DEFAULT_OPTIONS;\n\n        _classCallCheck(this, ConstantSourceNode);\n\n        var nativeContext = getNativeContext(context);\n\n        var mergedOptions = _objectSpread({}, DEFAULT_OPTIONS, {}, options);\n\n        var nativeConstantSourceNode = createNativeConstantSourceNode(nativeContext, mergedOptions);\n        var isOffline = isNativeOfflineAudioContext(nativeContext);\n        var constantSourceNodeRenderer = isOffline ? createConstantSourceNodeRendererFactory() : null;\n        _this = _possibleConstructorReturn(this, _getPrototypeOf(ConstantSourceNode).call(this, context, false, nativeConstantSourceNode, constantSourceNodeRenderer));\n        _this._constantSourceNodeRenderer = constantSourceNodeRenderer;\n        _this._nativeConstantSourceNode = nativeConstantSourceNode;\n        /*\n         * Bug #62 & #74: Edge & Safari do not support ConstantSourceNodes and do not export the correct values for maxValue and\n         * minValue for GainNodes.\n         */\n\n        _this._offset = createAudioParam(_assertThisInitialized(_this), isOffline, nativeConstantSourceNode.offset, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n        _this._onended = null;\n        return _this;\n      }\n\n      _createClass(ConstantSourceNode, [{\n        key: \"start\",\n        value: function start() {\n          var _this2 = this;\n\n          var when = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n          this._nativeConstantSourceNode.start(when);\n\n          if (this._constantSourceNodeRenderer !== null) {\n            this._constantSourceNodeRenderer.start = when;\n          } else {\n            setInternalStateToActive(this);\n\n            var resetInternalStateToPassive = function resetInternalStateToPassive() {\n              _this2._nativeConstantSourceNode.removeEventListener('ended', resetInternalStateToPassive); // @todo Determine a meaningful delay instead of just using one second.\n\n\n              setTimeout(function () {\n                return setInternalStateToPassive(_this2);\n              }, 1000);\n            };\n\n            this._nativeConstantSourceNode.addEventListener('ended', resetInternalStateToPassive);\n          }\n        }\n      }, {\n        key: \"stop\",\n        value: function stop() {\n          var when = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n          this._nativeConstantSourceNode.stop(when);\n\n          if (this._constantSourceNodeRenderer !== null) {\n            this._constantSourceNodeRenderer.stop = when;\n          }\n        }\n      }, {\n        key: \"offset\",\n        get: function get() {\n          return this._offset;\n        }\n      }, {\n        key: \"onended\",\n        get: function get() {\n          return this._onended;\n        },\n        set: function set(value) {\n          var wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n          this._nativeConstantSourceNode.onended = wrappedListener;\n          var nativeOnEnded = this._nativeConstantSourceNode.onended;\n          this._onended = nativeOnEnded !== null && nativeOnEnded === wrappedListener ? value : nativeOnEnded;\n        }\n      }]);\n\n      return ConstantSourceNode;\n    }(audioNodeConstructor)\n  );\n};","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/node_modules/standardized-audio-context/build/es2018/factories/constant-source-node-constructor.js"],"names":["MOST_NEGATIVE_SINGLE_FLOAT","MOST_POSITIVE_SINGLE_FLOAT","setInternalStateToActive","setInternalStateToPassive","DEFAULT_OPTIONS","channelCount","channelCountMode","channelInterpretation","offset","createConstantSourceNodeConstructor","audioNodeConstructor","createAudioParam","createConstantSourceNodeRendererFactory","createNativeConstantSourceNode","getNativeContext","isNativeOfflineAudioContext","wrapEventListener","context","options","nativeContext","mergedOptions","nativeConstantSourceNode","isOffline","constantSourceNodeRenderer","_constantSourceNodeRenderer","_nativeConstantSourceNode","_offset","_onended","when","start","resetInternalStateToPassive","removeEventListener","setTimeout","addEventListener","stop","value","wrappedListener","onended","nativeOnEnded"],"mappings":"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","sourcesContent":["import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    offset: 1\n};\nexport const createConstantSourceNodeConstructor = (audioNodeConstructor, createAudioParam, createConstantSourceNodeRendererFactory, createNativeConstantSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) => {\n    return class ConstantSourceNode extends audioNodeConstructor {\n        constructor(context, options = DEFAULT_OPTIONS) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeConstantSourceNode = createNativeConstantSourceNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const constantSourceNodeRenderer = ((isOffline)\n                ? createConstantSourceNodeRendererFactory()\n                : null);\n            super(context, false, nativeConstantSourceNode, constantSourceNodeRenderer);\n            this._constantSourceNodeRenderer = constantSourceNodeRenderer;\n            this._nativeConstantSourceNode = nativeConstantSourceNode;\n            /*\n             * Bug #62 & #74: Edge & Safari do not support ConstantSourceNodes and do not export the correct values for maxValue and\n             * minValue for GainNodes.\n             */\n            this._offset = createAudioParam(this, isOffline, nativeConstantSourceNode.offset, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._onended = null;\n        }\n        get offset() {\n            return this._offset;\n        }\n        get onended() {\n            return this._onended;\n        }\n        set onended(value) {\n            const wrappedListener = (typeof value === 'function') ? wrapEventListener(this, value) : null;\n            this._nativeConstantSourceNode.onended = wrappedListener;\n            const nativeOnEnded = this._nativeConstantSourceNode.onended;\n            this._onended = (nativeOnEnded !== null && nativeOnEnded === wrappedListener) ? value : nativeOnEnded;\n        }\n        start(when = 0) {\n            this._nativeConstantSourceNode.start(when);\n            if (this._constantSourceNodeRenderer !== null) {\n                this._constantSourceNodeRenderer.start = when;\n            }\n            else {\n                setInternalStateToActive(this);\n                const resetInternalStateToPassive = () => {\n                    this._nativeConstantSourceNode.removeEventListener('ended', resetInternalStateToPassive);\n                    // @todo Determine a meaningful delay instead of just using one second.\n                    setTimeout(() => setInternalStateToPassive(this), 1000);\n                };\n                this._nativeConstantSourceNode.addEventListener('ended', resetInternalStateToPassive);\n            }\n        }\n        stop(when = 0) {\n            this._nativeConstantSourceNode.stop(when);\n            if (this._constantSourceNodeRenderer !== null) {\n                this._constantSourceNodeRenderer.stop = when;\n            }\n        }\n    };\n};\n//# sourceMappingURL=/build/es2018/factories/constant-source-node-constructor.js.map"]},"metadata":{},"sourceType":"module"}