{"ast":null,"code":"import { interceptConnections } from '../helpers/intercept-connections';\nexport const createNativeStereoPannerNodeFakerFactory = (createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeGainNode, createNativeWaveShaperNode, createNotSupportedError, monitorConnections) => {\n  // The curve has a size of 14bit plus 1 value to have an exact representation for zero. This value has been determined experimentally.\n  const CURVE_SIZE = 16385;\n  const DC_CURVE = new Float32Array([1, 1]);\n  const HALF_PI = Math.PI / 2;\n  const SINGLE_CHANNEL_OPTIONS = {\n    channelCount: 1,\n    channelCountMode: 'explicit',\n    channelInterpretation: 'discrete'\n  };\n  const SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS = { ...SINGLE_CHANNEL_OPTIONS,\n    oversample: 'none'\n  };\n\n  const buildInternalGraphForMono = (nativeContext, inputGainNode, panGainNode, channelMergerNode) => {\n    const leftWaveShaperCurve = new Float32Array(CURVE_SIZE);\n    const rightWaveShaperCurve = new Float32Array(CURVE_SIZE);\n\n    for (let i = 0; i < CURVE_SIZE; i += 1) {\n      const x = i / (CURVE_SIZE - 1) * HALF_PI;\n      leftWaveShaperCurve[i] = Math.cos(x);\n      rightWaveShaperCurve[i] = Math.sin(x);\n    }\n\n    const leftGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS,\n      gain: 0\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const leftWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: leftWaveShaperCurve\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const panWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: DC_CURVE\n    });\n    const rightGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS,\n      gain: 0\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const rightWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: rightWaveShaperCurve\n    });\n    return {\n      connectGraph() {\n        inputGainNode.connect(leftGainNode);\n        inputGainNode.connect(panWaveShaperNode.inputs[0]);\n        inputGainNode.connect(rightGainNode);\n        panWaveShaperNode.connect(panGainNode);\n        panGainNode.connect(leftWaveShaperNode.inputs[0]);\n        panGainNode.connect(rightWaveShaperNode.inputs[0]);\n        leftWaveShaperNode.connect(leftGainNode.gain);\n        rightWaveShaperNode.connect(rightGainNode.gain);\n        leftGainNode.connect(channelMergerNode, 0, 0);\n        rightGainNode.connect(channelMergerNode, 0, 1);\n      },\n\n      disconnectGraph() {\n        inputGainNode.disconnect(leftGainNode);\n        inputGainNode.disconnect(panWaveShaperNode.inputs[0]);\n        inputGainNode.disconnect(rightGainNode);\n        panWaveShaperNode.disconnect(panGainNode);\n        panGainNode.disconnect(leftWaveShaperNode.inputs[0]);\n        panGainNode.disconnect(rightWaveShaperNode.inputs[0]);\n        leftWaveShaperNode.disconnect(leftGainNode.gain);\n        rightWaveShaperNode.disconnect(rightGainNode.gain);\n        leftGainNode.disconnect(channelMergerNode, 0, 0);\n        rightGainNode.disconnect(channelMergerNode, 0, 1);\n      }\n\n    };\n  };\n\n  const buildInternalGraphForStereo = (nativeContext, inputGainNode, panGainNode, channelMergerNode) => {\n    const leftInputForLeftOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n    const leftInputForRightOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n    const rightInputForLeftOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n    const rightInputForRightOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n    const centerIndex = Math.floor(CURVE_SIZE / 2);\n\n    for (let i = 0; i < CURVE_SIZE; i += 1) {\n      if (i > centerIndex) {\n        const x = (i - centerIndex) / (CURVE_SIZE - 1 - centerIndex) * HALF_PI;\n        leftInputForLeftOutputWaveShaperCurve[i] = Math.cos(x);\n        leftInputForRightOutputWaveShaperCurve[i] = Math.sin(x);\n        rightInputForLeftOutputWaveShaperCurve[i] = 0;\n        rightInputForRightOutputWaveShaperCurve[i] = 1;\n      } else {\n        const x = i / (CURVE_SIZE - 1 - centerIndex) * HALF_PI;\n        leftInputForLeftOutputWaveShaperCurve[i] = 1;\n        leftInputForRightOutputWaveShaperCurve[i] = 0;\n        rightInputForLeftOutputWaveShaperCurve[i] = Math.cos(x);\n        rightInputForRightOutputWaveShaperCurve[i] = Math.sin(x);\n      }\n    }\n\n    const channelSplitterNode = createNativeChannelSplitterNode(nativeContext, {\n      channelCount: 2,\n      channelCountMode: 'explicit',\n      channelInterpretation: 'discrete',\n      numberOfOutputs: 2\n    });\n    const leftInputForLeftOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS,\n      gain: 0\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const leftInputForLeftOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: leftInputForLeftOutputWaveShaperCurve\n    });\n    const leftInputForRightOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS,\n      gain: 0\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const leftInputForRightOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: leftInputForRightOutputWaveShaperCurve\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const panWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: DC_CURVE\n    });\n    const rightInputForLeftOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS,\n      gain: 0\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const rightInputForLeftOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: rightInputForLeftOutputWaveShaperCurve\n    });\n    const rightInputForRightOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS,\n      gain: 0\n    }); // Bug #119: Safari does not fully support the WaveShaperNode.\n\n    const rightInputForRightOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n      curve: rightInputForRightOutputWaveShaperCurve\n    });\n    return {\n      connectGraph() {\n        inputGainNode.connect(channelSplitterNode);\n        inputGainNode.connect(panWaveShaperNode.inputs[0]);\n        channelSplitterNode.connect(leftInputForLeftOutputGainNode, 1);\n        channelSplitterNode.connect(leftInputForRightOutputGainNode, 1);\n        channelSplitterNode.connect(rightInputForLeftOutputGainNode, 1);\n        channelSplitterNode.connect(rightInputForRightOutputGainNode, 1);\n        panWaveShaperNode.connect(panGainNode);\n        panGainNode.connect(leftInputForLeftOutputWaveShaperNode.inputs[0]);\n        panGainNode.connect(leftInputForRightOutputWaveShaperNode.inputs[0]);\n        panGainNode.connect(rightInputForLeftOutputWaveShaperNode.inputs[0]);\n        panGainNode.connect(rightInputForRightOutputWaveShaperNode.inputs[0]);\n        leftInputForLeftOutputWaveShaperNode.connect(leftInputForLeftOutputGainNode.gain);\n        leftInputForRightOutputWaveShaperNode.connect(leftInputForRightOutputGainNode.gain);\n        rightInputForLeftOutputWaveShaperNode.connect(rightInputForLeftOutputGainNode.gain);\n        rightInputForRightOutputWaveShaperNode.connect(rightInputForRightOutputGainNode.gain);\n        leftInputForLeftOutputGainNode.connect(channelMergerNode, 0, 0);\n        rightInputForLeftOutputGainNode.connect(channelMergerNode, 0, 0);\n        leftInputForRightOutputGainNode.connect(channelMergerNode, 0, 1);\n        rightInputForRightOutputGainNode.connect(channelMergerNode, 0, 1);\n      },\n\n      disconnectGraph() {\n        inputGainNode.disconnect(channelSplitterNode);\n        inputGainNode.disconnect(panWaveShaperNode.inputs[0]);\n        channelSplitterNode.disconnect(leftInputForLeftOutputGainNode, 1);\n        channelSplitterNode.disconnect(leftInputForRightOutputGainNode, 1);\n        channelSplitterNode.disconnect(rightInputForLeftOutputGainNode, 1);\n        channelSplitterNode.disconnect(rightInputForRightOutputGainNode, 1);\n        panWaveShaperNode.disconnect(panGainNode);\n        panGainNode.disconnect(leftInputForLeftOutputWaveShaperNode.inputs[0]);\n        panGainNode.disconnect(leftInputForRightOutputWaveShaperNode.inputs[0]);\n        panGainNode.disconnect(rightInputForLeftOutputWaveShaperNode.inputs[0]);\n        panGainNode.disconnect(rightInputForRightOutputWaveShaperNode.inputs[0]);\n        leftInputForLeftOutputWaveShaperNode.disconnect(leftInputForLeftOutputGainNode.gain);\n        leftInputForRightOutputWaveShaperNode.disconnect(leftInputForRightOutputGainNode.gain);\n        rightInputForLeftOutputWaveShaperNode.disconnect(rightInputForLeftOutputGainNode.gain);\n        rightInputForRightOutputWaveShaperNode.disconnect(rightInputForRightOutputGainNode.gain);\n        leftInputForLeftOutputGainNode.disconnect(channelMergerNode, 0, 0);\n        rightInputForLeftOutputGainNode.disconnect(channelMergerNode, 0, 0);\n        leftInputForRightOutputGainNode.disconnect(channelMergerNode, 0, 1);\n        rightInputForRightOutputGainNode.disconnect(channelMergerNode, 0, 1);\n      }\n\n    };\n  };\n\n  const buildInternalGraph = (nativeContext, channelCount, inputGainNode, panGainNode, channelMergerNode) => {\n    if (channelCount === 1) {\n      return buildInternalGraphForMono(nativeContext, inputGainNode, panGainNode, channelMergerNode);\n    }\n\n    if (channelCount === 2) {\n      return buildInternalGraphForStereo(nativeContext, inputGainNode, panGainNode, channelMergerNode);\n    }\n\n    throw createNotSupportedError();\n  };\n\n  return (nativeContext, {\n    channelCount,\n    channelCountMode,\n    pan,\n    ...audioNodeOptions\n  }) => {\n    if (channelCountMode === 'max') {\n      throw createNotSupportedError();\n    }\n\n    const channelMergerNode = createNativeChannelMergerNode(nativeContext, { ...audioNodeOptions,\n      channelCount: 1,\n      channelCountMode,\n      numberOfInputs: 2\n    });\n    const inputGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions,\n      channelCount,\n      channelCountMode,\n      gain: 1\n    });\n    const panGainNode = createNativeGainNode(nativeContext, {\n      channelCount: 1,\n      channelCountMode: 'explicit',\n      channelInterpretation: 'discrete',\n      gain: pan\n    });\n    let {\n      connectGraph,\n      disconnectGraph\n    } = buildInternalGraph(nativeContext, channelCount, inputGainNode, panGainNode, channelMergerNode);\n    Object.defineProperty(panGainNode.gain, 'defaultValue', {\n      get: () => 0\n    });\n    const nativeStereoPannerNodeFakerFactory = {\n      get bufferSize() {\n        return undefined;\n      },\n\n      get channelCount() {\n        return inputGainNode.channelCount;\n      },\n\n      set channelCount(value) {\n        if (inputGainNode.channelCount !== value) {\n          if (isConnected) {\n            disconnectGraph();\n          }\n\n          ({\n            connectGraph,\n            disconnectGraph\n          } = buildInternalGraph(nativeContext, value, inputGainNode, panGainNode, channelMergerNode));\n\n          if (isConnected) {\n            connectGraph();\n          }\n        }\n\n        inputGainNode.channelCount = value;\n      },\n\n      get channelCountMode() {\n        return inputGainNode.channelCountMode;\n      },\n\n      set channelCountMode(value) {\n        if (value === 'clamped-max' || value === 'max') {\n          throw createNotSupportedError();\n        }\n\n        inputGainNode.channelCountMode = value;\n      },\n\n      get channelInterpretation() {\n        return inputGainNode.channelInterpretation;\n      },\n\n      set channelInterpretation(value) {\n        inputGainNode.channelInterpretation = value;\n      },\n\n      get context() {\n        return inputGainNode.context;\n      },\n\n      get inputs() {\n        return [inputGainNode];\n      },\n\n      get numberOfInputs() {\n        return inputGainNode.numberOfInputs;\n      },\n\n      get numberOfOutputs() {\n        return inputGainNode.numberOfOutputs;\n      },\n\n      get pan() {\n        return panGainNode.gain;\n      },\n\n      addEventListener(...args) {\n        return inputGainNode.addEventListener(args[0], args[1], args[2]);\n      },\n\n      dispatchEvent(...args) {\n        return inputGainNode.dispatchEvent(args[0]);\n      },\n\n      removeEventListener(...args) {\n        return inputGainNode.removeEventListener(args[0], args[1], args[2]);\n      }\n\n    };\n    let isConnected = false;\n\n    const whenConnected = () => {\n      connectGraph();\n      isConnected = true;\n    };\n\n    const whenDisconnected = () => {\n      disconnectGraph();\n      isConnected = false;\n    };\n\n    return monitorConnections(interceptConnections(nativeStereoPannerNodeFakerFactory, channelMergerNode), whenConnected, whenDisconnected);\n  };\n};","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/node_modules/standardized-audio-context/build/es2018/factories/native-stereo-panner-node-faker-factory.js"],"names":["interceptConnections","createNativeStereoPannerNodeFakerFactory","createNativeChannelMergerNode","createNativeChannelSplitterNode","createNativeGainNode","createNativeWaveShaperNode","createNotSupportedError","monitorConnections","CURVE_SIZE","DC_CURVE","Float32Array","HALF_PI","Math","PI","SINGLE_CHANNEL_OPTIONS","channelCount","channelCountMode","channelInterpretation","SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS","oversample","buildInternalGraphForMono","nativeContext","inputGainNode","panGainNode","channelMergerNode","leftWaveShaperCurve","rightWaveShaperCurve","i","x","cos","sin","leftGainNode","gain","leftWaveShaperNode","curve","panWaveShaperNode","rightGainNode","rightWaveShaperNode","connectGraph","connect","inputs","disconnectGraph","disconnect","buildInternalGraphForStereo","leftInputForLeftOutputWaveShaperCurve","leftInputForRightOutputWaveShaperCurve","rightInputForLeftOutputWaveShaperCurve","rightInputForRightOutputWaveShaperCurve","centerIndex","floor","channelSplitterNode","numberOfOutputs","leftInputForLeftOutputGainNode","leftInputForLeftOutputWaveShaperNode","leftInputForRightOutputGainNode","leftInputForRightOutputWaveShaperNode","rightInputForLeftOutputGainNode","rightInputForLeftOutputWaveShaperNode","rightInputForRightOutputGainNode","rightInputForRightOutputWaveShaperNode","buildInternalGraph","pan","audioNodeOptions","numberOfInputs","Object","defineProperty","get","nativeStereoPannerNodeFakerFactory","bufferSize","undefined","value","isConnected","context","addEventListener","args","dispatchEvent","removeEventListener","whenConnected","whenDisconnected"],"mappings":"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","sourcesContent":["import { interceptConnections } from '../helpers/intercept-connections';\nexport const createNativeStereoPannerNodeFakerFactory = (createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeGainNode, createNativeWaveShaperNode, createNotSupportedError, monitorConnections) => {\n    // The curve has a size of 14bit plus 1 value to have an exact representation for zero. This value has been determined experimentally.\n    const CURVE_SIZE = 16385;\n    const DC_CURVE = new Float32Array([1, 1]);\n    const HALF_PI = Math.PI / 2;\n    const SINGLE_CHANNEL_OPTIONS = { channelCount: 1, channelCountMode: 'explicit', channelInterpretation: 'discrete' };\n    const SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS = { ...SINGLE_CHANNEL_OPTIONS, oversample: 'none' };\n    const buildInternalGraphForMono = (nativeContext, inputGainNode, panGainNode, channelMergerNode) => {\n        const leftWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const rightWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        for (let i = 0; i < CURVE_SIZE; i += 1) {\n            const x = (i / (CURVE_SIZE - 1)) * HALF_PI;\n            leftWaveShaperCurve[i] = Math.cos(x);\n            rightWaveShaperCurve[i] = Math.sin(x);\n        }\n        const leftGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const leftWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: leftWaveShaperCurve });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const panWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: DC_CURVE });\n        const rightGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const rightWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: rightWaveShaperCurve });\n        return {\n            connectGraph() {\n                inputGainNode.connect(leftGainNode);\n                inputGainNode.connect(panWaveShaperNode.inputs[0]);\n                inputGainNode.connect(rightGainNode);\n                panWaveShaperNode.connect(panGainNode);\n                panGainNode.connect(leftWaveShaperNode.inputs[0]);\n                panGainNode.connect(rightWaveShaperNode.inputs[0]);\n                leftWaveShaperNode.connect(leftGainNode.gain);\n                rightWaveShaperNode.connect(rightGainNode.gain);\n                leftGainNode.connect(channelMergerNode, 0, 0);\n                rightGainNode.connect(channelMergerNode, 0, 1);\n            },\n            disconnectGraph() {\n                inputGainNode.disconnect(leftGainNode);\n                inputGainNode.disconnect(panWaveShaperNode.inputs[0]);\n                inputGainNode.disconnect(rightGainNode);\n                panWaveShaperNode.disconnect(panGainNode);\n                panGainNode.disconnect(leftWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(rightWaveShaperNode.inputs[0]);\n                leftWaveShaperNode.disconnect(leftGainNode.gain);\n                rightWaveShaperNode.disconnect(rightGainNode.gain);\n                leftGainNode.disconnect(channelMergerNode, 0, 0);\n                rightGainNode.disconnect(channelMergerNode, 0, 1);\n            }\n        };\n    };\n    const buildInternalGraphForStereo = (nativeContext, inputGainNode, panGainNode, channelMergerNode) => {\n        const leftInputForLeftOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const leftInputForRightOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const rightInputForLeftOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const rightInputForRightOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const centerIndex = Math.floor(CURVE_SIZE / 2);\n        for (let i = 0; i < CURVE_SIZE; i += 1) {\n            if (i > centerIndex) {\n                const x = ((i - centerIndex) / (CURVE_SIZE - 1 - centerIndex)) * HALF_PI;\n                leftInputForLeftOutputWaveShaperCurve[i] = Math.cos(x);\n                leftInputForRightOutputWaveShaperCurve[i] = Math.sin(x);\n                rightInputForLeftOutputWaveShaperCurve[i] = 0;\n                rightInputForRightOutputWaveShaperCurve[i] = 1;\n            }\n            else {\n                const x = (i / (CURVE_SIZE - 1 - centerIndex)) * HALF_PI;\n                leftInputForLeftOutputWaveShaperCurve[i] = 1;\n                leftInputForRightOutputWaveShaperCurve[i] = 0;\n                rightInputForLeftOutputWaveShaperCurve[i] = Math.cos(x);\n                rightInputForRightOutputWaveShaperCurve[i] = Math.sin(x);\n            }\n        }\n        const channelSplitterNode = createNativeChannelSplitterNode(nativeContext, {\n            channelCount: 2,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            numberOfOutputs: 2\n        });\n        const leftInputForLeftOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const leftInputForLeftOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: leftInputForLeftOutputWaveShaperCurve });\n        const leftInputForRightOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const leftInputForRightOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: leftInputForRightOutputWaveShaperCurve });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const panWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: DC_CURVE });\n        const rightInputForLeftOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const rightInputForLeftOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: rightInputForLeftOutputWaveShaperCurve });\n        const rightInputForRightOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const rightInputForRightOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: rightInputForRightOutputWaveShaperCurve });\n        return {\n            connectGraph() {\n                inputGainNode.connect(channelSplitterNode);\n                inputGainNode.connect(panWaveShaperNode.inputs[0]);\n                channelSplitterNode.connect(leftInputForLeftOutputGainNode, 1);\n                channelSplitterNode.connect(leftInputForRightOutputGainNode, 1);\n                channelSplitterNode.connect(rightInputForLeftOutputGainNode, 1);\n                channelSplitterNode.connect(rightInputForRightOutputGainNode, 1);\n                panWaveShaperNode.connect(panGainNode);\n                panGainNode.connect(leftInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.connect(leftInputForRightOutputWaveShaperNode.inputs[0]);\n                panGainNode.connect(rightInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.connect(rightInputForRightOutputWaveShaperNode.inputs[0]);\n                leftInputForLeftOutputWaveShaperNode.connect(leftInputForLeftOutputGainNode.gain);\n                leftInputForRightOutputWaveShaperNode.connect(leftInputForRightOutputGainNode.gain);\n                rightInputForLeftOutputWaveShaperNode.connect(rightInputForLeftOutputGainNode.gain);\n                rightInputForRightOutputWaveShaperNode.connect(rightInputForRightOutputGainNode.gain);\n                leftInputForLeftOutputGainNode.connect(channelMergerNode, 0, 0);\n                rightInputForLeftOutputGainNode.connect(channelMergerNode, 0, 0);\n                leftInputForRightOutputGainNode.connect(channelMergerNode, 0, 1);\n                rightInputForRightOutputGainNode.connect(channelMergerNode, 0, 1);\n            },\n            disconnectGraph() {\n                inputGainNode.disconnect(channelSplitterNode);\n                inputGainNode.disconnect(panWaveShaperNode.inputs[0]);\n                channelSplitterNode.disconnect(leftInputForLeftOutputGainNode, 1);\n                channelSplitterNode.disconnect(leftInputForRightOutputGainNode, 1);\n                channelSplitterNode.disconnect(rightInputForLeftOutputGainNode, 1);\n                channelSplitterNode.disconnect(rightInputForRightOutputGainNode, 1);\n                panWaveShaperNode.disconnect(panGainNode);\n                panGainNode.disconnect(leftInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(leftInputForRightOutputWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(rightInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(rightInputForRightOutputWaveShaperNode.inputs[0]);\n                leftInputForLeftOutputWaveShaperNode.disconnect(leftInputForLeftOutputGainNode.gain);\n                leftInputForRightOutputWaveShaperNode.disconnect(leftInputForRightOutputGainNode.gain);\n                rightInputForLeftOutputWaveShaperNode.disconnect(rightInputForLeftOutputGainNode.gain);\n                rightInputForRightOutputWaveShaperNode.disconnect(rightInputForRightOutputGainNode.gain);\n                leftInputForLeftOutputGainNode.disconnect(channelMergerNode, 0, 0);\n                rightInputForLeftOutputGainNode.disconnect(channelMergerNode, 0, 0);\n                leftInputForRightOutputGainNode.disconnect(channelMergerNode, 0, 1);\n                rightInputForRightOutputGainNode.disconnect(channelMergerNode, 0, 1);\n            }\n        };\n    };\n    const buildInternalGraph = (nativeContext, channelCount, inputGainNode, panGainNode, channelMergerNode) => {\n        if (channelCount === 1) {\n            return buildInternalGraphForMono(nativeContext, inputGainNode, panGainNode, channelMergerNode);\n        }\n        if (channelCount === 2) {\n            return buildInternalGraphForStereo(nativeContext, inputGainNode, panGainNode, channelMergerNode);\n        }\n        throw createNotSupportedError();\n    };\n    return (nativeContext, { channelCount, channelCountMode, pan, ...audioNodeOptions }) => {\n        if (channelCountMode === 'max') {\n            throw createNotSupportedError();\n        }\n        const channelMergerNode = createNativeChannelMergerNode(nativeContext, {\n            ...audioNodeOptions,\n            channelCount: 1,\n            channelCountMode,\n            numberOfInputs: 2\n        });\n        const inputGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, channelCount, channelCountMode, gain: 1 });\n        const panGainNode = createNativeGainNode(nativeContext, {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            gain: pan\n        });\n        let { connectGraph, disconnectGraph } = buildInternalGraph(nativeContext, channelCount, inputGainNode, panGainNode, channelMergerNode);\n        Object.defineProperty(panGainNode.gain, 'defaultValue', { get: () => 0 });\n        const nativeStereoPannerNodeFakerFactory = {\n            get bufferSize() {\n                return undefined;\n            },\n            get channelCount() {\n                return inputGainNode.channelCount;\n            },\n            set channelCount(value) {\n                if (inputGainNode.channelCount !== value) {\n                    if (isConnected) {\n                        disconnectGraph();\n                    }\n                    ({ connectGraph, disconnectGraph } = buildInternalGraph(nativeContext, value, inputGainNode, panGainNode, channelMergerNode));\n                    if (isConnected) {\n                        connectGraph();\n                    }\n                }\n                inputGainNode.channelCount = value;\n            },\n            get channelCountMode() {\n                return inputGainNode.channelCountMode;\n            },\n            set channelCountMode(value) {\n                if (value === 'clamped-max' || value === 'max') {\n                    throw createNotSupportedError();\n                }\n                inputGainNode.channelCountMode = value;\n            },\n            get channelInterpretation() {\n                return inputGainNode.channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                inputGainNode.channelInterpretation = value;\n            },\n            get context() {\n                return inputGainNode.context;\n            },\n            get inputs() {\n                return [inputGainNode];\n            },\n            get numberOfInputs() {\n                return inputGainNode.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return inputGainNode.numberOfOutputs;\n            },\n            get pan() {\n                return panGainNode.gain;\n            },\n            addEventListener(...args) {\n                return inputGainNode.addEventListener(args[0], args[1], args[2]);\n            },\n            dispatchEvent(...args) {\n                return inputGainNode.dispatchEvent(args[0]);\n            },\n            removeEventListener(...args) {\n                return inputGainNode.removeEventListener(args[0], args[1], args[2]);\n            }\n        };\n        let isConnected = false;\n        const whenConnected = () => {\n            connectGraph();\n            isConnected = true;\n        };\n        const whenDisconnected = () => {\n            disconnectGraph();\n            isConnected = false;\n        };\n        return monitorConnections(interceptConnections(nativeStereoPannerNodeFakerFactory, channelMergerNode), whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=/build/es2018/factories/native-stereo-panner-node-faker-factory.js.map"]},"metadata":{},"sourceType":"module"}