{"ast":null,"code":"import React,{useEffect}from\"react\";import Collapse from\"react-css-collapse\";import{autoUnlockAudio}from\"../../../active-audio-context\";import{useDeviceType}from\"../../hooks/useDeviceType\";import{Spinner}from\"../../shared/Spinner\";import{Controller}from\"./Controller\";import{Session}from\"./Session\";import{SessionHeader}from\"./SessionHeader\";import{Sidebar}from\"./Sidebar\";import{useFullscreen}from\"./useFullscreen\";import{useKeyboardListener}from\"./useKeyboardListener\";import{usePlayer}from\"./usePlayer\";import{useSession}from\"./useSession\";export var Player=function Player(_ref){var _player$control;var audioset=_ref.audioset;var session=useSession(audioset);var player=usePlayer(audioset,session.loader);var _useFullscreen=useFullscreen(),isFullscreen=_useFullscreen.isFullscreen,toggleFullscreen=_useFullscreen.toggleFullscreen;var _useDeviceType=useDeviceType(),isMobile=_useDeviceType.isMobile;useKeyboardListener((_player$control=player.control)===null||_player$control===void 0?void 0:_player$control.keyboard);useEffect(function(){return autoUnlockAudio();},[]);var isSidebarVisible=!isFullscreen;var areVisualsHidden=isMobile&&session.visible;var showControl=true;var showSession=session.started&&!session.visible;var Header=function Header(){return/*#__PURE__*/React.createElement(SessionHeader,{meta:audioset.meta,onToggle:session.started?session.toggle:session.start,isOpen:showSession});};// const Header = () =>\n//   session.started && !session.visible ? (\n//     <SessionHeader meta={audioset.meta} session={session} />\n//   ) : (\n//     <BundleHeader meta={audioset.meta} />\n//   );\nreturn/*#__PURE__*/React.createElement(\"div\",{className:\"App Player\"},isSidebarVisible&&/*#__PURE__*/React.createElement(Sidebar,{header:Header,audioset:audioset,onFullscreen:toggleFullscreen,onStopAll:function onStopAll(){var _player$control2;return player===null||player===void 0?void 0:(_player$control2=player.control)===null||_player$control2===void 0?void 0:_player$control2.stopAll(0);}},/*#__PURE__*/React.createElement(Collapse,{isOpen:session.loading},/*#__PURE__*/React.createElement(Spinner,{center:\"horizontal\"})),/*#__PURE__*/React.createElement(Collapse,{isOpen:session.visible},/*#__PURE__*/React.createElement(Session,{audioset:audioset,isStarted:session.started,onStart:function onStart(){return session.start();}})),/*#__PURE__*/React.createElement(Collapse,{isOpen:showControl},/*#__PURE__*/React.createElement(Controller,{audioset:audioset,state:player.state,control:!session.visible?player.control:undefined,onResume:session.start}))),/*#__PURE__*/React.createElement(\"div\",{className:\"visuals\",style:{display:areVisualsHidden?\"none\":\"\"}},/*#__PURE__*/React.createElement(\"div\",{className:areVisualsHidden?\"\":\"visuals-display\",ref:player.visualsRef})));};","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/packages/player/src/ui/components/Player/Player.tsx"],"names":["React","useEffect","Collapse","autoUnlockAudio","useDeviceType","Spinner","Controller","Session","SessionHeader","Sidebar","useFullscreen","useKeyboardListener","usePlayer","useSession","Player","audioset","session","player","loader","isFullscreen","toggleFullscreen","isMobile","control","keyboard","isSidebarVisible","areVisualsHidden","visible","showControl","showSession","started","Header","meta","toggle","start","stopAll","loading","state","undefined","display","visualsRef"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\nimport Collapse from \"react-css-collapse\";\nimport { autoUnlockAudio } from \"../../../active-audio-context\";\nimport { Audioset } from \"../../../audioset\";\nimport { useDeviceType } from \"../../hooks/useDeviceType\";\nimport { Spinner } from \"../../shared/Spinner\";\nimport { Controller } from \"./Controller\";\nimport { Session } from \"./Session\";\nimport { SessionHeader } from \"./SessionHeader\";\nimport { Sidebar } from \"./Sidebar\";\nimport { useFullscreen } from \"./useFullscreen\";\nimport { useKeyboardListener } from \"./useKeyboardListener\";\nimport { usePlayer } from \"./usePlayer\";\nimport { useSession } from \"./useSession\";\n\nexport interface PlayerProps {\n  audioset: Audioset;\n}\n\nexport const Player = ({ audioset }: PlayerProps) => {\n  const session = useSession(audioset);\n  const player = usePlayer(audioset, session.loader);\n  const { isFullscreen, toggleFullscreen } = useFullscreen();\n  const { isMobile } = useDeviceType();\n  useKeyboardListener(player.control?.keyboard);\n\n  useEffect(() => autoUnlockAudio(), []);\n\n  const isSidebarVisible = !isFullscreen;\n  const areVisualsHidden = isMobile && session.visible;\n  const showControl = true;\n  const showSession = session.started && !session.visible;\n\n  const Header = () => (\n    <SessionHeader\n      meta={audioset.meta}\n      onToggle={session.started ? session.toggle : session.start}\n      isOpen={showSession}\n    />\n  );\n  // const Header = () =>\n  //   session.started && !session.visible ? (\n  //     <SessionHeader meta={audioset.meta} session={session} />\n  //   ) : (\n  //     <BundleHeader meta={audioset.meta} />\n  //   );\n\n  return (\n    <div className=\"App Player\">\n      {isSidebarVisible && (\n        <Sidebar\n          header={Header}\n          audioset={audioset}\n          onFullscreen={toggleFullscreen}\n          onStopAll={() => player?.control?.stopAll(0)}\n        >\n          <Collapse isOpen={session.loading}>\n            <Spinner center=\"horizontal\" />\n          </Collapse>\n          <Collapse isOpen={session.visible}>\n            <Session\n              audioset={audioset}\n              isStarted={session.started}\n              onStart={() => session.start()}\n            />\n          </Collapse>\n          <Collapse isOpen={showControl}>\n            <Controller\n              audioset={audioset}\n              state={player.state}\n              control={!session.visible ? player.control : undefined}\n              onResume={session.start}\n            />\n          </Collapse>\n        </Sidebar>\n      )}\n      <div\n        className=\"visuals\"\n        style={{ display: areVisualsHidden ? \"none\" : \"\" }}\n      >\n        <div\n          className={areVisualsHidden ? \"\" : \"visuals-display\"}\n          ref={player.visualsRef}\n        />\n      </div>\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}