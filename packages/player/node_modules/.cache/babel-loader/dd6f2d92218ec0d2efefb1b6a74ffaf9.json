{"ast":null,"code":"import _classCallCheck from\"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import debounce from\"lodash.debounce\";import Display from\"./display\";import Visuals from\"./visuals\";export var VisualControl=/*#__PURE__*/function(){function VisualControl(audioset,el){var _this=this;_classCallCheck(this,VisualControl);this.el=el;this.display=void 0;this.visuals=void 0;this.handleResize=void 0;this.display=new Display(el);this.visuals=new Visuals(audioset,this.display);setupVisuals(audioset,this.visuals);this.handleResize=debounce(function(){_this.visuals.resizeSvg();});window.addEventListener(el,this.handleResize);}_createClass(VisualControl,[{key:\"startClip\",value:function startClip(clipId){this.visuals.show(clipId);}},{key:\"stopClip\",value:function stopClip(clipId){this.visuals.hide(clipId);}},{key:\"detach\",value:function detach(){window.removeEventListener(this.el,this.handleResize);}}]);return VisualControl;}();function setupVisuals(audioset,visuals){if(audioset.visuals.mode===\"map\"){fetch(audioset.visuals.geomap.url).then(function(response){return response.json();}).then(function(data){return visuals.setGeodata(data);});}else{visuals.setup();}}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/visuals/index.ts"],"names":["debounce","Display","Visuals","VisualControl","audioset","el","display","visuals","handleResize","setupVisuals","resizeSvg","window","addEventListener","clipId","show","hide","removeEventListener","mode","fetch","geomap","url","then","response","json","data","setGeodata","setup"],"mappings":"sTAAA,MAAOA,CAAAA,QAAP,KAAqB,iBAArB,CAEA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CAEA,UAAaC,CAAAA,aAAb,yBAKE,uBAAYC,QAAZ,CAAwCC,EAAxC,CAAiD,yDAATA,EAAS,CAATA,EAAS,MAJzCC,OAIyC,aAHzCC,OAGyC,aAFzCC,YAEyC,QAC/C,KAAKF,OAAL,CAAe,GAAIL,CAAAA,OAAJ,CAAYI,EAAZ,CAAf,CACA,KAAKE,OAAL,CAAe,GAAIL,CAAAA,OAAJ,CAAYE,QAAZ,CAAsB,KAAKE,OAA3B,CAAf,CACAG,YAAY,CAACL,QAAD,CAAW,KAAKG,OAAhB,CAAZ,CAEA,KAAKC,YAAL,CAAoBR,QAAQ,CAAC,UAAM,CACjC,KAAI,CAACO,OAAL,CAAaG,SAAb,GACD,CAF2B,CAA5B,CAIAC,MAAM,CAACC,gBAAP,CAAwBP,EAAxB,CAA4B,KAAKG,YAAjC,EACD,CAfH,sEAiBmBK,MAjBnB,CAiBmC,CAC/B,KAAKN,OAAL,CAAaO,IAAb,CAAkBD,MAAlB,EACD,CAnBH,0CAqBkBA,MArBlB,CAqBkC,CAC9B,KAAKN,OAAL,CAAaQ,IAAb,CAAkBF,MAAlB,EACD,CAvBH,uCAyBkB,CACdF,MAAM,CAACK,mBAAP,CAA2B,KAAKX,EAAhC,CAAoC,KAAKG,YAAzC,EACD,CA3BH,6BA8BA,QAASC,CAAAA,YAAT,CAAsBL,QAAtB,CAA0CG,OAA1C,CAA4D,CAC1D,GAAIH,QAAQ,CAACG,OAAT,CAAiBU,IAAjB,GAA0B,KAA9B,CAAqC,CACnCC,KAAK,CAACd,QAAQ,CAACG,OAAT,CAAiBY,MAAjB,CAAwBC,GAAzB,CAAL,CACGC,IADH,CACQ,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADhB,EAEGF,IAFH,CAEQ,SAAAG,IAAI,QAAIjB,CAAAA,OAAO,CAACkB,UAAR,CAAmBD,IAAnB,CAAJ,EAFZ,EAGD,CAJD,IAIO,CACLjB,OAAO,CAACmB,KAAR,GACD,CACF","sourcesContent":["import debounce from \"lodash.debounce\";\nimport { Audioset } from \"../audioset\";\nimport Display from \"./display\";\nimport Visuals from \"./visuals\";\n\nexport class VisualControl {\n  private display: Display;\n  private visuals: Visuals;\n  private handleResize: any;\n\n  constructor(audioset: Audioset, private el: any) {\n    this.display = new Display(el);\n    this.visuals = new Visuals(audioset, this.display);\n    setupVisuals(audioset, this.visuals);\n\n    this.handleResize = debounce(() => {\n      this.visuals.resizeSvg();\n    });\n\n    window.addEventListener(el, this.handleResize);\n  }\n\n  public startClip(clipId: string) {\n    this.visuals.show(clipId);\n  }\n\n  public stopClip(clipId: string) {\n    this.visuals.hide(clipId);\n  }\n\n  public detach() {\n    window.removeEventListener(this.el, this.handleResize);\n  }\n}\n\nfunction setupVisuals(audioset: Audioset, visuals: Visuals) {\n  if (audioset.visuals.mode === \"map\") {\n    fetch(audioset.visuals.geomap.url)\n      .then(response => response.json())\n      .then(data => visuals.setGeodata(data));\n  } else {\n    visuals.setup();\n  }\n}\n"]},"metadata":{},"sourceType":"module"}