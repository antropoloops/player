{"ast":null,"code":"import _slicedToArray from \"/Users/dani/Antropoloops/atpls-player/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/dani/Antropoloops/atpls-player/src/ui/Player/Player.tsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { getActiveAudioContext } from \"../../player\";\nimport { AudiosetControl, EmptyControlState } from \"../../player/Control\";\nimport { useDeviceType } from \"../useDeviceType\";\nimport { Controller } from \"./Controller\";\nimport { Preview } from \"./Preview\";\nimport { Sidebar } from \"./Sidebar\";\nimport { useFullscreen } from \"./useFullscreen\";\nimport { useKeyboardListener } from \"./useKeyboardListener\";\nimport { Visuals } from \"./Visuals\";\nexport const Player = ({\n  audioset\n}) => {\n  const _usePlayer = usePlayer(audioset),\n        player = _usePlayer.player,\n        playerState = _usePlayer.playerState;\n\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        isReady = _useState2[0],\n        setReady = _useState2[1];\n\n  const _useFullscreen = useFullscreen(),\n        isFullscreen = _useFullscreen.isFullscreen,\n        toggleFullscreen = _useFullscreen.toggleFullscreen;\n\n  const _useDeviceType = useDeviceType(),\n        isDesktop = _useDeviceType.isDesktop;\n\n  useKeyboardListener();\n  const isVisual = isDesktop || isReady;\n  const isSidebarVisible = !isFullscreen; // useAutoStartAudio(isReady, audioset, handleStart);\n\n  return React.createElement(\"div\", {\n    className: \"App Player\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  }, isSidebarVisible && React.createElement(Sidebar, {\n    audioset: audioset,\n    onFullscreen: toggleFullscreen,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33\n    },\n    __self: this\n  }, isReady ? React.createElement(Controller, {\n    audioset: audioset,\n    player: player,\n    state: playerState,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35\n    },\n    __self: this\n  }) : React.createElement(Preview, {\n    audioset: audioset,\n    isReady: isReady,\n    onStart: () => setReady(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  })), isVisual && React.createElement(\"div\", {\n    className: \"visuals\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, React.createElement(Visuals, {\n    audioset: audioset,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  })));\n};\n\nfunction usePlayer(audioset) {\n  const _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        player = _useState4[0],\n        setPlayer = _useState4[1];\n\n  const _useState5 = useState(EmptyControlState),\n        _useState6 = _slicedToArray(_useState5, 2),\n        playerState = _useState6[0],\n        setPlayerState = _useState6[1];\n\n  useEffect(() => {\n    getActiveAudioContext().then(ctx => {\n      const control = new AudiosetControl(audioset, {\n        onControlStateChanged: state => {\n          setPlayerState(state);\n        },\n        onControlCommand: command => {// console.log(\"command!\", command);\n        }\n      });\n      setPlayer(control);\n      setPlayerState(control.getState());\n    });\n  }, [audioset]);\n  return {\n    player,\n    playerState\n  };\n}","map":{"version":3,"sources":["/Users/dani/Antropoloops/atpls-player/src/ui/Player/Player.tsx"],"names":["React","useEffect","useState","getActiveAudioContext","AudiosetControl","EmptyControlState","useDeviceType","Controller","Preview","Sidebar","useFullscreen","useKeyboardListener","Visuals","Player","audioset","usePlayer","player","playerState","isReady","setReady","isFullscreen","toggleFullscreen","isDesktop","isVisual","isSidebarVisible","setPlayer","setPlayerState","then","ctx","control","onControlStateChanged","state","onControlCommand","command","getState"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AAEA,SAASC,qBAAT,QAAsC,cAAtC;AACA,SAASC,eAAT,EAA0BC,iBAA1B,QAAmD,sBAAnD;AAEA,SAASC,aAAT,QAA8B,kBAA9B;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAASC,OAAT,QAAwB,WAAxB;AACA,SAASC,OAAT,QAAwB,WAAxB;AACA,SAASC,aAAT,QAA8B,iBAA9B;AACA,SAASC,mBAAT,QAAoC,uBAApC;AACA,SAASC,OAAT,QAAwB,WAAxB;AAMA,OAAO,MAAMC,MAAM,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAA+B;AAAA,qBACnBC,SAAS,CAACD,QAAD,CADU;AAAA,QAC3CE,MAD2C,cAC3CA,MAD2C;AAAA,QACnCC,WADmC,cACnCA,WADmC;;AAAA,oBAEvBf,QAAQ,CAAU,KAAV,CAFe;AAAA;AAAA,QAE5CgB,OAF4C;AAAA,QAEnCC,QAFmC;;AAAA,yBAGRT,aAAa,EAHL;AAAA,QAG3CU,YAH2C,kBAG3CA,YAH2C;AAAA,QAG7BC,gBAH6B,kBAG7BA,gBAH6B;;AAAA,yBAI7Bf,aAAa,EAJgB;AAAA,QAI3CgB,SAJ2C,kBAI3CA,SAJ2C;;AAKnDX,EAAAA,mBAAmB;AAEnB,QAAMY,QAAQ,GAAGD,SAAS,IAAIJ,OAA9B;AAEA,QAAMM,gBAAgB,GAAG,CAACJ,YAA1B,CATmD,CAUnD;;AAEA,SACE;AAAK,IAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGI,gBAAgB,IACf,oBAAC,OAAD;AAAS,IAAA,QAAQ,EAAEV,QAAnB;AAA6B,IAAA,YAAY,EAAEO,gBAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGH,OAAO,GACN,oBAAC,UAAD;AACE,IAAA,QAAQ,EAAEJ,QADZ;AAEE,IAAA,MAAM,EAAEE,MAFV;AAGE,IAAA,KAAK,EAAEC,WAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADM,GAON,oBAAC,OAAD;AACE,IAAA,QAAQ,EAAEH,QADZ;AAEE,IAAA,OAAO,EAAEI,OAFX;AAGE,IAAA,OAAO,EAAE,MAAMC,QAAQ,CAAC,IAAD,CAHzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARJ,CAFJ,EAkBGI,QAAQ,IACP;AAAK,IAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA0B,oBAAC,OAAD;AAAS,IAAA,QAAQ,EAAET,QAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAA1B,CAnBJ,CADF;AAwBD,CApCM;;AAsCP,SAASC,SAAT,CAAmBD,QAAnB,EAAuC;AAAA,qBACTZ,QAAQ,CAAuB,IAAvB,CADC;AAAA;AAAA,QAC9Bc,MAD8B;AAAA,QACtBS,SADsB;;AAAA,qBAECvB,QAAQ,CAACG,iBAAD,CAFT;AAAA;AAAA,QAE9BY,WAF8B;AAAA,QAEjBS,cAFiB;;AAIrCzB,EAAAA,SAAS,CAAC,MAAM;AACdE,IAAAA,qBAAqB,GAAGwB,IAAxB,CAA6BC,GAAG,IAAI;AAClC,YAAMC,OAAO,GAAG,IAAIzB,eAAJ,CAAoBU,QAApB,EAA8B;AAC5CgB,QAAAA,qBAAqB,EAAEC,KAAK,IAAI;AAC9BL,UAAAA,cAAc,CAACK,KAAD,CAAd;AACD,SAH2C;AAI5CC,QAAAA,gBAAgB,EAAEC,OAAO,IAAI,CAC3B;AACD;AAN2C,OAA9B,CAAhB;AAQAR,MAAAA,SAAS,CAACI,OAAD,CAAT;AACAH,MAAAA,cAAc,CAACG,OAAO,CAACK,QAAR,EAAD,CAAd;AACD,KAXD;AAYD,GAbQ,EAaN,CAACpB,QAAD,CAbM,CAAT;AAeA,SAAO;AAAEE,IAAAA,MAAF;AAAUC,IAAAA;AAAV,GAAP;AACD","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Audioset } from \"../../audioset\";\nimport { getActiveAudioContext } from \"../../player\";\nimport { AudiosetControl, EmptyControlState } from \"../../player/Control\";\nimport { PlayerControl } from \"../../player/Control/ControlStateManager\";\nimport { useDeviceType } from \"../useDeviceType\";\nimport { Controller } from \"./Controller\";\nimport { Preview } from \"./Preview\";\nimport { Sidebar } from \"./Sidebar\";\nimport { useFullscreen } from \"./useFullscreen\";\nimport { useKeyboardListener } from \"./useKeyboardListener\";\nimport { Visuals } from \"./Visuals\";\n\nexport interface PlayerProps {\n  audioset: Audioset;\n}\n\nexport const Player = ({ audioset }: PlayerProps) => {\n  const { player, playerState } = usePlayer(audioset);\n  const [isReady, setReady] = useState<boolean>(false);\n  const { isFullscreen, toggleFullscreen } = useFullscreen();\n  const { isDesktop } = useDeviceType();\n  useKeyboardListener();\n\n  const isVisual = isDesktop || isReady;\n\n  const isSidebarVisible = !isFullscreen;\n  // useAutoStartAudio(isReady, audioset, handleStart);\n\n  return (\n    <div className=\"App Player\">\n      {isSidebarVisible && (\n        <Sidebar audioset={audioset} onFullscreen={toggleFullscreen}>\n          {isReady ? (\n            <Controller\n              audioset={audioset}\n              player={player}\n              state={playerState}\n            />\n          ) : (\n            <Preview\n              audioset={audioset}\n              isReady={isReady}\n              onStart={() => setReady(true)}\n            />\n          )}\n        </Sidebar>\n      )}\n      {isVisual && (\n        <div className=\"visuals\">{<Visuals audioset={audioset} />}</div>\n      )}\n    </div>\n  );\n};\n\nfunction usePlayer(audioset: Audioset) {\n  const [player, setPlayer] = useState<PlayerControl | null>(null);\n  const [playerState, setPlayerState] = useState(EmptyControlState);\n\n  useEffect(() => {\n    getActiveAudioContext().then(ctx => {\n      const control = new AudiosetControl(audioset, {\n        onControlStateChanged: state => {\n          setPlayerState(state);\n        },\n        onControlCommand: command => {\n          // console.log(\"command!\", command);\n        },\n      });\n      setPlayer(control);\n      setPlayerState(control.getState());\n    });\n  }, [audioset]);\n\n  return { player, playerState };\n}\n"]},"metadata":{},"sourceType":"module"}